"use client";
"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _chunkANF53NYRcjs = require('./chunk-ANF53NYR.cjs');var _react = require('react');var o,s;function v(e){typeof window>"u"||typeof EventSource>"u"||!e||s||(s=e,o=new EventSource(`${e}/events`),l(),window.addEventListener("vercel-toolbar-ready",()=>{l()}))}function l(){let e=_chunkANF53NYRcjs.b.call(void 0, );_optionalChain([e, 'optionalAccess', _ => _.isAuthenticated])&&_optionalChain([e, 'access', _2 => _2.setLocalhostEventSource, 'optionalCall', _3 => _3({subscribe:i,fetchLocal:p})])}function i(e,n){if(!o)return()=>{};let r=t=>{try{let c=t.data&&typeof t.data=="string"?JSON.parse(t.data):void 0;c&&n(c)}catch (e2){}};return o.addEventListener(e,r),()=>{_optionalChain([o, 'optionalAccess', _4 => _4.removeEventListener, 'call', _5 => _5(e,r)])}}async function p(e,n){if(!s)return{error:"No toolbar server"};try{let r=await fetch(`${s}${e}`,n?{method:"POST",body:JSON.stringify(n)}:void 0),t=await r.json();return r.ok?{result:t}:{error:t.error}}catch(r){return{error:`${r}`}}}async function m(){let e=await p("/branch");return"result"in e?e.result.branch:void 0}function E(){i("branch-change",e=>{e&&location.reload()})}function N(){return process.env.NODE_ENV!=="development"||_react.useEffect.call(void 0, ()=>(v(process.env.NEXT_PUBLIC_VERCEL_TOOLBAR_SERVER),E(),m().then(e=>{e&&_chunkANF53NYRcjs.a.call(void 0, e),_chunkANF53NYRcjs.c.call(void 0, )}),()=>{_chunkANF53NYRcjs.d.call(void 0, )}),[]),null}exports.LocalhostController = N;
