import{c as d}from"../chunk-OX3X3MOB.js";import{f as t}from"../chunk-2NER6YV7.js";import{join as p}from"path";import{readFileSync as f}from"fs";import a from"execa";import m from"find-up";function u(){try{let e=m.sync(r=>m.sync.exists(p(r,".vercel","project.json"))?r:void 0,{type:"directory"});if(t("Found vercel directory",e),e){let r=JSON.parse(f(p(e,".vercel","project.json"),"utf8"));return t("Found vercel project.json",r),{ownerId:r.orgId,projectId:r.projectId}}console.log("[vercel-toolbar] No project info found. Make sure you run `vc link` in your project directory.")}catch(e){t("Error finding project info",e);return}}function E(){try{let e=a.sync("git",["branch","--show-current"]);return!e.stdout&&e.stderr&&t("Error getting current git branch",e.stderr),e.stdout.trim()}catch(e){t("Error getting current git branch",e);return}}function I(e={}){return{name:"vite-plugin-vercel-toolbar",config:(r,{mode:n})=>{let i={"import.meta.env.VERCEL_TOOLBAR_DEPLOYMENT_ID":process.env.VERCEL_DEPLOYMENT_ID?`"${process.env.VERCEL_DEPLOYMENT_ID}"`:"undefined"},o,c;return n==="development"&&(o=u(),c=E()),o?{define:{"import.meta.env.VERCEL_TOOLBAR_SERVER":`"http://localhost:${d({portFromConfig:e.devServerPort})}"`,"import.meta.env.VERCEL_TOOLBAR_OWNER_ID":`"${o.ownerId}"`,"import.meta.env.VERCEL_TOOLBAR_PROJECT_ID":`"${o.projectId}"`,"import.meta.env.VERCEL_TOOLBAR_BRANCH":`"${c??""}"`,...i}}:{define:{"import.meta.env.VERCEL_TOOLBAR_SERVER":"undefined","import.meta.env.VERCEL_TOOLBAR_OWNER_ID":"undefined","import.meta.env.VERCEL_TOOLBAR_PROJECT_ID":"undefined","import.meta.env.VERCEL_TOOLBAR_BRANCH":"undefined",...i}}}}}export{I as vercelToolbar};
